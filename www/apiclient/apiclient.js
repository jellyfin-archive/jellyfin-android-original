(function(globalScope,JSON,WebSocket,setTimeout,devicePixelRatio,FileReader){if(!globalScope.MediaBrowser){globalScope.MediaBrowser={};}
globalScope.MediaBrowser.ApiClient=function(logger,serverAddress,clientName,applicationVersion,deviceName,deviceId){if(!serverAddress){throw new Error("Must supply a serverAddress");}
logger.log('ApiClient serverAddress: '+serverAddress);logger.log('ApiClient clientName: '+clientName);logger.log('ApiClient applicationVersion: '+applicationVersion);logger.log('ApiClient deviceName: '+deviceName);logger.log('ApiClient deviceId: '+deviceId);var self=this;var webSocket;var serverInfo={};self.enableAppStorePolicy=false;self.serverAddress=function(val){if(val!=null){if(val.toLowerCase().indexOf('http')!=0){throw new Error('Invalid url: '+val);}
var changed=val!=serverAddress;serverAddress=val;if(changed){Events.trigger(this,'serveraddresschanged');}}
return serverAddress;};self.serverInfo=function(info){serverInfo=info||serverInfo;return serverInfo;};var currentUserPromise;self.getCurrentUser=function(){var promise=currentUserPromise;if(promise==null){promise=self.getUser(self.getCurrentUserId()).fail(function(){currentUserPromise=null;});currentUserPromise=promise;}
return promise;};self.getCurrentUserId=function(){return serverInfo.UserId;};self.accessToken=function(){return serverInfo.AccessToken;};self.deviceName=function(){return deviceName;};self.deviceId=function(){return deviceId;};self.appName=function(){return clientName;};self.appVersion=function(){return applicationVersion;};self.clearAuthenticationInfo=function(){self.setAuthenticationInfo(null,null);};self.setAuthenticationInfo=function(accessKey,userId){currentUserPromise=null;serverInfo.AccessToken=accessKey;serverInfo.UserId=userId;};self.encodeName=function(name){name=name.split('/').join('-');name=name.split('&').join('-');name=name.split('?').join('-');var val=HttpClient.param({name:name});return val.substring(val.indexOf('=')+1).replace("'",'%27');};function onRequestFail(e){Events.trigger(self,'requestfail',[{url:this.url,type:this.type,status:e.status,errorCode:e.getResponseHeader("X-Application-Error-Code")}]);}
function onRetryRequestFail(request){Events.trigger(self,'requestfail',[{url:request.url}]);}
self.setRequestHeaders=function(headers){var currentServerInfo=self.serverInfo();if(clientName){var auth='MediaBrowser Client="'+clientName+'", Device="'+deviceName+'", DeviceId="'+deviceId+'", Version="'+applicationVersion+'"';var userId=currentServerInfo.UserId;if(userId){auth+=', UserId="'+userId+'"';}
headers["X-Emby-Authorization"]=auth;}
var accessToken=currentServerInfo.AccessToken;if(accessToken){headers['X-MediaBrowser-Token']=accessToken;}};self.ajax=function(request,includeAuthorization){if(!request){throw new Error("Request cannot be null");}
if(includeAuthorization!==false){request.headers=request.headers||{};self.setRequestHeaders(request.headers);}
if(self.enableAutomaticNetworking===false||request.type!="GET"){logger.log('Requesting url without automatic networking: '+request.url);return HttpClient.send(request).fail(onRequestFail);}
var deferred=DeferredBuilder.Deferred();self.ajaxWithFailover(request,deferred,true);return deferred.promise();};function switchConnectionMode(connectionMode){var currentServerInfo=self.serverInfo();var newConnectionMode=connectionMode;newConnectionMode--;if(newConnectionMode<0){newConnectionMode=MediaBrowser.ConnectionMode.Manual;}
if(MediaBrowser.ServerInfo.getServerAddress(currentServerInfo,newConnectionMode)){return newConnectionMode;}
newConnectionMode--;if(newConnectionMode<0){newConnectionMode=MediaBrowser.ConnectionMode.Manual;}
if(MediaBrowser.ServerInfo.getServerAddress(currentServerInfo,newConnectionMode)){return newConnectionMode;}
return connectionMode;}
function tryReconnectInternal(deferred,connectionMode,currentRetryCount){connectionMode=switchConnectionMode(connectionMode);var url=MediaBrowser.ServerInfo.getServerAddress(self.serverInfo(),connectionMode);logger.log("Attempting reconnection to "+url);var timeout=connectionMode==MediaBrowser.ConnectionMode.Local?7000:15000;HttpClient.send({type:"GET",url:url+"/system/info/public",dataType:"json",timeout:timeout}).done(function(){logger.log("Reconnect succeeded to "+url);self.serverInfo().LastConnectionMode=connectionMode;self.serverAddress(url);deferred.resolve();}).fail(function(){logger.log("Reconnect attempt failed to "+url);if(currentRetryCount<5){var newConnectionMode=switchConnectionMode(connectionMode);setTimeout(function(){tryReconnectInternal(deferred,newConnectionMode,currentRetryCount+1);},500);}else{deferred.reject();}});}
function tryReconnect(){var deferred=DeferredBuilder.Deferred();setTimeout(function(){tryReconnectInternal(deferred,self.serverInfo().LastConnectionMode,0);},500);return deferred.promise();}
self.ajaxWithFailover=function(request,deferred,enableReconnection){logger.log("Requesting "+request.url);request.timeout=30000;HttpClient.send(request).done(function(response){deferred.resolve(response,0);}).fail(function(e,textStatus){logger.log("Request failed with textStatus "+textStatus+" to "+request.url);var statusCode=parseInt(e.status||'0');var isUserErrorCode=statusCode>=400&&statusCode<500;if(enableReconnection&&!isUserErrorCode){logger.log("Attempting reconnection");var previousServerAddress=self.serverAddress();tryReconnect().done(function(){logger.log("Reconnect succeesed");request.url=request.url.replace(previousServerAddress,self.serverAddress());self.ajaxWithFailover(request,deferred,false);}).fail(function(){logger.log("Reconnect failed");onRetryRequestFail(request);deferred.reject();});}else{logger.log("Reporting request failure");onRetryRequestFail(request);deferred.reject();}});};self.get=function(url){return self.ajax({type:"GET",url:url});};self.getJSON=function(url){return self.ajax({type:"GET",url:url,dataType:"json"});};self.getUrl=function(name,params){if(!name){throw new Error("Url name cannot be empty");}
var url=serverAddress;if(!url){throw new Error("serverAddress is yet not set");}
if(name.charAt(0)!='/'){url+='/';}
url+=name;if(params){url+="?"+HttpClient.param(params);}
return url;};self.updateServerInfo=function(server,connectionMode){if(server==null){throw new Error('server cannot be null');}
if(connectionMode==null){throw new Error('connectionMode cannot be null');}
logger.log('Begin updateServerInfo. connectionMode: '+connectionMode);self.serverInfo(server);var serverUrl=MediaBrowser.ServerInfo.getServerAddress(server,connectionMode);if(!serverUrl){throw new Error('serverUrl cannot be null. serverInfo: '+JSON.stringify(server));}
logger.log('Setting server address to '+serverUrl);self.serverAddress(serverUrl);};self.isWebSocketSupported=function(){return WebSocket!=null;};self.openWebSocket=function(){var accessToken=self.accessToken();if(!accessToken){throw new Error("Cannot open web socket without access token.");}
var url=serverAddress.replace('http','ws');url+="?api_key="+accessToken;url+="&deviceId="+deviceId;webSocket=new WebSocket(url);webSocket.onmessage=function(msg){msg=JSON.parse(msg.data);onWebSocketMessage(msg);};webSocket.onopen=function(){logger.log('web socket connection opened');setTimeout(function(){Events.trigger(self,'websocketopen');},0);};webSocket.onerror=function(){setTimeout(function(){Events.trigger(self,'websocketerror');},0);};webSocket.onclose=function(){setTimeout(function(){Events.trigger(self,'websocketclose');},0);};};self.closeWebSocket=function(){if(webSocket&&webSocket.readyState===WebSocket.OPEN){webSocket.close();}};function onWebSocketMessage(msg){if(msg.MessageType==="UserDeleted"){currentUserPromise=null;}
else if(msg.MessageType==="UserUpdated"||msg.MessageType==="UserConfigurationUpdated"){var user=msg.Data;if(user.Id==self.getCurrentUserId()){currentUserPromise=null;}}
Events.trigger(self,'websocketmessage',[msg]);}
self.sendWebSocketMessage=function(name,data){logger.log('Sending web socket message: '+name);var msg={MessageType:name};if(data){msg.Data=data;}
msg=JSON.stringify(msg);webSocket.send(msg);};self.isWebSocketOpen=function(){return webSocket&&webSocket.readyState===WebSocket.OPEN;};self.isWebSocketOpenOrConnecting=function(){return webSocket&&(webSocket.readyState===WebSocket.OPEN||webSocket.readyState===WebSocket.CONNECTING);};self.getProductNews=function(options){options=options||{};var url=self.getUrl("News/Product",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getDownloadSpeed=function(byteSize){var url=self.getUrl('Playback/BitrateTest',{Size:byteSize});var deferred=DeferredBuilder.Deferred();var now=new Date().getTime();self.get(url).done(function(){var responseTimeSeconds=(new Date().getTime()-now)/1000;var bytesPerSecond=byteSize/responseTimeSeconds;var bitrate=Math.round(bytesPerSecond*8);deferred.resolveWith(null,[bitrate]);}).fail(function(){deferred.reject();});return deferred.promise();};self.detectBitrate=function(){var deferred=DeferredBuilder.Deferred();self.getDownloadSpeed(1000000).done(function(bitrate){if(bitrate<1000000){deferred.resolveWith(null,[Math.round(bitrate*.8)]);}else{self.getDownloadSpeed(2400000).done(function(bitrate){deferred.resolveWith(null,[Math.round(bitrate*.8)]);}).fail(function(){deferred.reject();});}}).fail(function(){deferred.reject();});return deferred.promise();};self.getItem=function(userId,itemId){if(!itemId){throw new Error("null itemId");}
var url=userId?self.getUrl("Users/"+userId+"/Items/"+itemId):self.getUrl("Items/"+itemId);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getRootFolder=function(userId){if(!userId){throw new Error("null userId");}
var url=self.getUrl("Users/"+userId+"/Items/Root");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getNotificationSummary=function(userId){if(!userId){throw new Error("null userId");}
var url=self.getUrl("Notifications/"+userId+"/Summary");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getNotifications=function(userId,options){if(!userId){throw new Error("null userId");}
var url=self.getUrl("Notifications/"+userId,options||{});return self.ajax({type:"GET",url:url,dataType:"json"});};self.markNotificationsRead=function(userId,idList,isRead){if(!userId){throw new Error("null userId");}
if(!idList){throw new Error("null idList");}
var suffix=isRead?"Read":"Unread";var params={UserId:userId,Ids:idList.join(',')};var url=self.getUrl("Notifications/"+userId+"/"+suffix,params);return self.ajax({type:"POST",url:url});};self.logout=function(){self.closeWebSocket();var done=function(){self.setAuthenticationInfo(null,null);};if(self.accessToken()){var url=self.getUrl("Sessions/Logout");return self.ajax({type:"POST",url:url}).always(done);}
var deferred=DeferredBuilder.Deferred();done();deferred.resolveWith(null,[]);return deferred.promise();};function getRemoteImagePrefix(options){var urlPrefix;if(options.artist){urlPrefix="Artists/"+self.encodeName(options.artist);delete options.artist;}else if(options.person){urlPrefix="Persons/"+self.encodeName(options.person);delete options.person;}else if(options.genre){urlPrefix="Genres/"+self.encodeName(options.genre);delete options.genre;}else if(options.musicGenre){urlPrefix="MusicGenres/"+self.encodeName(options.musicGenre);delete options.musicGenre;}else if(options.gameGenre){urlPrefix="GameGenres/"+self.encodeName(options.gameGenre);delete options.gameGenre;}else if(options.studio){urlPrefix="Studios/"+self.encodeName(options.studio);delete options.studio;}else{urlPrefix="Items/"+options.itemId;delete options.itemId;}
return urlPrefix;}
self.getRemoteImageProviders=function(options){if(!options){throw new Error("null options");}
var urlPrefix=getRemoteImagePrefix(options);var url=self.getUrl(urlPrefix+"/RemoteImages/Providers",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getAvailableRemoteImages=function(options){if(!options){throw new Error("null options");}
var urlPrefix=getRemoteImagePrefix(options);var url=self.getUrl(urlPrefix+"/RemoteImages",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.downloadRemoteImage=function(options){if(!options){throw new Error("null options");}
var urlPrefix=getRemoteImagePrefix(options);var url=self.getUrl(urlPrefix+"/RemoteImages/Download",options);return self.ajax({type:"POST",url:url});};self.getLiveTvInfo=function(options){var url=self.getUrl("LiveTv/Info",options||{});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getLiveTvGuideInfo=function(options){var url=self.getUrl("LiveTv/GuideInfo",options||{});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getLiveTvChannel=function(id,userId){if(!id){throw new Error("null id");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("LiveTv/Channels/"+id,options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getLiveTvChannels=function(options){var url=self.getUrl("LiveTv/Channels",options||{});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getLiveTvPrograms=function(options){options=options||{};if(options.channelIds&&options.channelIds.length>1800){return self.ajax({type:"POST",url:self.getUrl("LiveTv/Programs"),data:JSON.stringify(options),contentType:"application/json",dataType:"json"});}else{return self.ajax({type:"GET",url:self.getUrl("LiveTv/Programs",options),dataType:"json"});}};self.getLiveTvRecommendedPrograms=function(options){options=options||{};return self.ajax({type:"GET",url:self.getUrl("LiveTv/Programs/Recommended",options),dataType:"json"});};self.getLiveTvRecordings=function(options){var url=self.getUrl("LiveTv/Recordings",options||{});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getLiveTvRecordingGroups=function(options){var url=self.getUrl("LiveTv/Recordings/Groups",options||{});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getLiveTvRecordingGroup=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("LiveTv/Recordings/Groups/"+id);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getLiveTvRecording=function(id,userId){if(!id){throw new Error("null id");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("LiveTv/Recordings/"+id,options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getLiveTvProgram=function(id,userId){if(!id){throw new Error("null id");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("LiveTv/Programs/"+id,options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.deleteLiveTvRecording=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("LiveTv/Recordings/"+id);return self.ajax({type:"DELETE",url:url});};self.cancelLiveTvTimer=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("LiveTv/Timers/"+id);return self.ajax({type:"DELETE",url:url});};self.getLiveTvTimers=function(options){var url=self.getUrl("LiveTv/Timers",options||{});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getLiveTvTimer=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("LiveTv/Timers/"+id);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getNewLiveTvTimerDefaults=function(options){options=options||{};var url=self.getUrl("LiveTv/Timers/Defaults",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.createLiveTvTimer=function(item){if(!item){throw new Error("null item");}
var url=self.getUrl("LiveTv/Timers");return self.ajax({type:"POST",url:url,data:JSON.stringify(item),contentType:"application/json"});};self.updateLiveTvTimer=function(item){if(!item){throw new Error("null item");}
var url=self.getUrl("LiveTv/Timers/"+item.Id);return self.ajax({type:"POST",url:url,data:JSON.stringify(item),contentType:"application/json"});};self.resetLiveTvTuner=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("LiveTv/Tuners/"+id+"/Reset");return self.ajax({type:"POST",url:url});};self.getLiveTvSeriesTimers=function(options){var url=self.getUrl("LiveTv/SeriesTimers",options||{});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getFileOrganizationResults=function(options){var url=self.getUrl("Library/FileOrganization",options||{});return self.ajax({type:"GET",url:url,dataType:"json"});};self.deleteOriginalFileFromOrganizationResult=function(id){var url=self.getUrl("Library/FileOrganizations/"+id+"/File");return self.ajax({type:"DELETE",url:url});};self.clearOrganizationLog=function(){var url=self.getUrl("Library/FileOrganizations");return self.ajax({type:"DELETE",url:url});};self.performOrganization=function(id){var url=self.getUrl("Library/FileOrganizations/"+id+"/Organize");return self.ajax({type:"POST",url:url});};self.performEpisodeOrganization=function(id,options){var url=self.getUrl("Library/FileOrganizations/"+id+"/Episode/Organize",options||{});return self.ajax({type:"POST",url:url});};self.getLiveTvSeriesTimer=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("LiveTv/SeriesTimers/"+id);return self.ajax({type:"GET",url:url,dataType:"json"});};self.cancelLiveTvSeriesTimer=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("LiveTv/SeriesTimers/"+id);return self.ajax({type:"DELETE",url:url});};self.createLiveTvSeriesTimer=function(item){if(!item){throw new Error("null item");}
var url=self.getUrl("LiveTv/SeriesTimers");return self.ajax({type:"POST",url:url,data:JSON.stringify(item),contentType:"application/json"});};self.updateLiveTvSeriesTimer=function(item){if(!item){throw new Error("null item");}
var url=self.getUrl("LiveTv/SeriesTimers/"+item.Id);return self.ajax({type:"POST",url:url,data:JSON.stringify(item),contentType:"application/json"});};self.getRegistrationInfo=function(feature){var url=self.getUrl("Registrations/"+feature);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getSystemInfo=function(){var url=self.getUrl("System/Info");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getPublicSystemInfo=function(){var url=self.getUrl("System/Info/Public");return self.ajax({type:"GET",url:url,dataType:"json"},false);};self.getInstantMixFromItem=function(itemId,options){var url=self.getUrl("Items/"+itemId+"/InstantMix",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getEpisodes=function(itemId,options){var url=self.getUrl("Shows/"+itemId+"/Episodes",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getDisplayPreferences=function(id,userId,app){var url=self.getUrl("DisplayPreferences/"+id,{userId:userId,client:app});return self.ajax({type:"GET",url:url,dataType:"json"});};self.updateDisplayPreferences=function(id,obj,userId,app){var url=self.getUrl("DisplayPreferences/"+id,{userId:userId,client:app});return self.ajax({type:"POST",url:url,data:JSON.stringify(obj),contentType:"application/json"});};self.getSeasons=function(itemId,options){var url=self.getUrl("Shows/"+itemId+"/Seasons",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getSimilarItems=function(itemId,options){var url=self.getUrl("Items/"+itemId+"/Similar",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getCultures=function(){var url=self.getUrl("Localization/cultures");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getCountries=function(){var url=self.getUrl("Localization/countries");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getPluginSecurityInfo=function(){var url=self.getUrl("Plugins/SecurityInfo");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getDirectoryContents=function(path,options){if(!path){throw new Error("null path");}
options=options||{};options.path=path;var url=self.getUrl("Environment/DirectoryContents",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getNetworkShares=function(path){if(!path){throw new Error("null path");}
var options={};options.path=path;var url=self.getUrl("Environment/NetworkShares",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getParentPath=function(path){if(!path){throw new Error("null path");}
var options={};options.path=path;var url=self.getUrl("Environment/ParentPath",options);return self.ajax({type:"GET",url:url});};self.getDrives=function(){var url=self.getUrl("Environment/Drives");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getNetworkDevices=function(){var url=self.getUrl("Environment/NetworkDevices");return self.ajax({type:"GET",url:url,dataType:"json"});};self.cancelPackageInstallation=function(installationId){if(!installationId){throw new Error("null installationId");}
var url=self.getUrl("Packages/Installing/"+installationId);return self.ajax({type:"DELETE",url:url});};self.refreshItem=function(itemId,options){if(!itemId){throw new Error("null itemId");}
var url=self.getUrl("Items/"+itemId+"/Refresh",options||{});return self.ajax({type:"POST",url:url});};self.installPlugin=function(name,guid,updateClass,version){if(!name){throw new Error("null name");}
if(!updateClass){throw new Error("null updateClass");}
var options={updateClass:updateClass,AssemblyGuid:guid};if(version){options.version=version;}
var url=self.getUrl("Packages/Installed/"+name,options);return self.ajax({type:"POST",url:url});};self.restartServer=function(){var url=self.getUrl("System/Restart");return self.ajax({type:"POST",url:url});};self.shutdownServer=function(){var url=self.getUrl("System/Shutdown");return self.ajax({type:"POST",url:url});};self.getPackageInfo=function(name,guid){if(!name){throw new Error("null name");}
var options={AssemblyGuid:guid};var url=self.getUrl("Packages/"+name,options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getAvailableApplicationUpdate=function(){var url=self.getUrl("Packages/Updates",{PackageType:"System"});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getAvailablePluginUpdates=function(){var url=self.getUrl("Packages/Updates",{PackageType:"UserInstalled"});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getVirtualFolders=function(){var url="Library/VirtualFolders";url=self.getUrl(url);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getPhysicalPaths=function(){var url=self.getUrl("Library/PhysicalPaths");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getServerConfiguration=function(){var url=self.getUrl("System/Configuration");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getDevicesOptions=function(){var url=self.getUrl("System/Configuration/devices");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getContentUploadHistory=function(){var url=self.getUrl("Devices/CameraUploads",{DeviceId:self.deviceId()});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getNamedConfiguration=function(name){var url=self.getUrl("System/Configuration/"+name);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getScheduledTasks=function(options){options=options||{};var url=self.getUrl("ScheduledTasks",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.startScheduledTask=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("ScheduledTasks/Running/"+id);return self.ajax({type:"POST",url:url});};self.getScheduledTask=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("ScheduledTasks/"+id);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getNextUpEpisodes=function(options){var url=self.getUrl("Shows/NextUp",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.stopScheduledTask=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("ScheduledTasks/Running/"+id);return self.ajax({type:"DELETE",url:url});};self.getPluginConfiguration=function(id){if(!id){throw new Error("null Id");}
var url=self.getUrl("Plugins/"+id+"/Configuration");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getAvailablePlugins=function(options){options=options||{};options.PackageType="UserInstalled";if(self.enableAppStorePolicy){options.IsAppStoreEnabled=true;}
var url=self.getUrl("Packages",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.uninstallPlugin=function(id){if(!id){throw new Error("null Id");}
var url=self.getUrl("Plugins/"+id);return self.ajax({type:"DELETE",url:url});};self.removeVirtualFolder=function(name,refreshLibrary){if(!name){throw new Error("null name");}
var url="Library/VirtualFolders";url=self.getUrl(url,{refreshLibrary:refreshLibrary?true:false,name:name});return self.ajax({type:"DELETE",url:url});};self.addVirtualFolder=function(name,type,refreshLibrary){if(!name){throw new Error("null name");}
var options={};if(type){options.collectionType=type;}
options.refreshLibrary=refreshLibrary?true:false;options.name=name;var url="Library/VirtualFolders";url=self.getUrl(url,options);return self.ajax({type:"POST",url:url});};self.renameVirtualFolder=function(name,newName,refreshLibrary){if(!name){throw new Error("null name");}
var url="Library/VirtualFolders/Name";url=self.getUrl(url,{refreshLibrary:refreshLibrary?true:false,newName:newName,name:name});return self.ajax({type:"POST",url:url});};self.addMediaPath=function(virtualFolderName,mediaPath,refreshLibrary){if(!virtualFolderName){throw new Error("null virtualFolderName");}
if(!mediaPath){throw new Error("null mediaPath");}
var url="Library/VirtualFolders/Paths";url=self.getUrl(url,{refreshLibrary:refreshLibrary?true:false,path:mediaPath,name:virtualFolderName});return self.ajax({type:"POST",url:url});};self.removeMediaPath=function(virtualFolderName,mediaPath,refreshLibrary){if(!virtualFolderName){throw new Error("null virtualFolderName");}
if(!mediaPath){throw new Error("null mediaPath");}
var url="Library/VirtualFolders/Paths";url=self.getUrl(url,{refreshLibrary:refreshLibrary?true:false,path:mediaPath,name:virtualFolderName});return self.ajax({type:"DELETE",url:url});};self.deleteUser=function(id){if(!id){throw new Error("null id");}
var url=self.getUrl("Users/"+id);return self.ajax({type:"DELETE",url:url});};self.deleteUserImage=function(userId,imageType,imageIndex){if(!userId){throw new Error("null userId");}
if(!imageType){throw new Error("null imageType");}
var url=self.getUrl("Users/"+userId+"/Images/"+imageType);if(imageIndex!=null){url+="/"+imageIndex;}
return self.ajax({type:"DELETE",url:url});};self.deleteItemImage=function(itemId,imageType,imageIndex){if(!imageType){throw new Error("null imageType");}
var url=self.getUrl("Items/"+itemId+"/Images");url+="/"+imageType;if(imageIndex!=null){url+="/"+imageIndex;}
return self.ajax({type:"DELETE",url:url});};self.deleteItem=function(itemId){if(!itemId){throw new Error("null itemId");}
var url=self.getUrl("Items/"+itemId);return self.ajax({type:"DELETE",url:url});};self.stopActiveEncodings=function(playSessionId){var options={deviceId:deviceId};if(playSessionId){options.PlaySessionId=playSessionId;}
var url=self.getUrl("Videos/ActiveEncodings",options);return self.ajax({type:"DELETE",url:url});};self.reportCapabilities=function(options){var url=self.getUrl("Sessions/Capabilities/Full");return self.ajax({type:"POST",url:url,data:JSON.stringify(options),contentType:"application/json"});};self.updateItemImageIndex=function(itemId,imageType,imageIndex,newIndex){if(!imageType){throw new Error("null imageType");}
var options={newIndex:newIndex};var url=self.getUrl("Items/"+itemId+"/Images/"+imageType+"/"+imageIndex+"/Index",options);return self.ajax({type:"POST",url:url});};self.getItemImageInfos=function(itemId){var url=self.getUrl("Items/"+itemId+"/Images");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getCriticReviews=function(itemId,options){if(!itemId){throw new Error("null itemId");}
var url=self.getUrl("Items/"+itemId+"/CriticReviews",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getSessions=function(options){var url=self.getUrl("Sessions",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.uploadUserImage=function(userId,imageType,file){if(!userId){throw new Error("null userId");}
if(!imageType){throw new Error("null imageType");}
if(!file){throw new Error("File must be an image.");}
if(file.type!="image/png"&&file.type!="image/jpeg"&&file.type!="image/jpeg"){throw new Error("File must be an image.");}
var deferred=DeferredBuilder.Deferred();var reader=new FileReader();reader.onerror=function(){deferred.reject();};reader.onabort=function(){deferred.reject();};reader.onload=function(e){var data=e.target.result.split(',')[1];var url=self.getUrl("Users/"+userId+"/Images/"+imageType);self.ajax({type:"POST",url:url,data:data,contentType:"image/"+file.name.substring(file.name.lastIndexOf('.')+1)}).done(function(result){deferred.resolveWith(null,[result]);}).fail(function(){deferred.reject();});};reader.readAsDataURL(file);return deferred.promise();};self.uploadItemImage=function(itemId,imageType,file){if(!itemId){throw new Error("null itemId");}
if(!imageType){throw new Error("null imageType");}
if(!file){throw new Error("File must be an image.");}
if(file.type!="image/png"&&file.type!="image/jpeg"&&file.type!="image/jpeg"){throw new Error("File must be an image.");}
var url=self.getUrl("Items/"+itemId+"/Images");url+="/"+imageType;var deferred=DeferredBuilder.Deferred();var reader=new FileReader();reader.onerror=function(){deferred.reject();};reader.onabort=function(){deferred.reject();};reader.onload=function(e){var data=e.target.result.split(',')[1];self.ajax({type:"POST",url:url,data:data,contentType:"image/"+file.name.substring(file.name.lastIndexOf('.')+1)}).done(function(result){deferred.resolveWith(null,[result]);}).fail(function(){deferred.reject();});};reader.readAsDataURL(file);return deferred.promise();};self.getInstalledPlugins=function(){var options={};if(self.enableAppStorePolicy){options.IsAppStoreEnabled=true;}
var url=self.getUrl("Plugins",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getUser=function(id){if(!id){throw new Error("Must supply a userId");}
var url=self.getUrl("Users/"+id);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getOfflineUser=function(id){if(!id){throw new Error("Must supply a userId");}
var url=self.getUrl("Users/"+id+"/Offline");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getStudio=function(name,userId){if(!name){throw new Error("null name");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("Studios/"+self.encodeName(name),options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getGenre=function(name,userId){if(!name){throw new Error("null name");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("Genres/"+self.encodeName(name),options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getMusicGenre=function(name,userId){if(!name){throw new Error("null name");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("MusicGenres/"+self.encodeName(name),options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getGameGenre=function(name,userId){if(!name){throw new Error("null name");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("GameGenres/"+self.encodeName(name),options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getArtist=function(name,userId){if(!name){throw new Error("null name");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("Artists/"+self.encodeName(name),options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getPerson=function(name,userId){if(!name){throw new Error("null name");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("Persons/"+self.encodeName(name),options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getPublicUsers=function(){var url=self.getUrl("users/public");return self.ajax({type:"GET",url:url,dataType:"json"},false);};self.getUsers=function(options){var url=self.getUrl("users",options||{});return self.ajax({type:"GET",url:url,dataType:"json"});};self.getParentalRatings=function(){var url=self.getUrl("Localization/ParentalRatings");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getDefaultImageQuality=function(imageType){return imageType.toLowerCase()=='backdrop'?80:90;};function normalizeImageOptions(options){var ratio=devicePixelRatio||1;if(ratio){if(options.minScale){ratio=Math.max(options.minScale,ratio);}
if(options.width){options.width=Math.round(options.width*ratio);}
if(options.height){options.height=Math.round(options.height*ratio);}
if(options.maxWidth){options.maxWidth=Math.round(options.maxWidth*ratio);}
if(options.maxHeight){options.maxHeight=Math.round(options.maxHeight*ratio);}}
options.quality=options.quality||self.getDefaultImageQuality(options.type);if(self.normalizeImageOptions){self.normalizeImageOptions(options);}}
self.getUserImageUrl=function(userId,options){if(!userId){throw new Error("null userId");}
options=options||{};var url="Users/"+userId+"/Images/"+options.type;if(options.index!=null){url+="/"+options.index;}
normalizeImageOptions(options);delete options.type;delete options.index;return self.getUrl(url,options);};self.getImageUrl=function(itemId,options){if(!itemId){throw new Error("itemId cannot be empty");}
options=options||{};var url="Items/"+itemId+"/Images/"+options.type;if(options.index!=null){url+="/"+options.index;}
options.quality=options.quality||self.getDefaultImageQuality(options.type);if(self.normalizeImageOptions){self.normalizeImageOptions(options);}
delete options.type;delete options.index;return self.getUrl(url,options);};self.getScaledImageUrl=function(itemId,options){if(!itemId){throw new Error("itemId cannot be empty");}
options=options||{};var url="Items/"+itemId+"/Images/"+options.type;if(options.index!=null){url+="/"+options.index;}
normalizeImageOptions(options);delete options.type;delete options.index;delete options.minScale;return self.getUrl(url,options);};self.getThumbImageUrl=function(item,options){if(!item){throw new Error("null item");}
options=options||{};options.imageType="thumb";var itemId=item.ImageTags&&item.ImageTags.Thumb?item.Id:item.ParentThumbItemId;return itemId?self.getImageUrl(itemId,options):null;};self.authenticateUserByName=function(name,password){var deferred=DeferredBuilder.Deferred();if(!name){deferred.reject();return deferred.promise();}
var url=self.getUrl("Users/authenticatebyname");require(["cryptojs-sha1"],function(){var postData={password:CryptoJS.SHA1(password||"").toString(),Username:name};self.ajax({type:"POST",url:url,data:JSON.stringify(postData),dataType:"json",contentType:"application/json"}).done(function(result){if(self.onAuthenticated){self.onAuthenticated(self,result);}
deferred.resolveWith(null,[result]);}).fail(function(){deferred.reject();});});return deferred.promise();};self.updateUserPassword=function(userId,currentPassword,newPassword){var deferred=DeferredBuilder.Deferred();if(!userId){deferred.reject();return deferred.promise();}
var url=self.getUrl("Users/"+userId+"/Password");require(["cryptojs-sha1"],function(){self.ajax({type:"POST",url:url,data:{currentPassword:CryptoJS.SHA1(currentPassword).toString(),newPassword:CryptoJS.SHA1(newPassword).toString()}}).done(function(result){deferred.resolveWith(null,[result]);}).fail(function(){deferred.reject();});});return deferred.promise();};self.updateEasyPassword=function(userId,newPassword){var deferred=DeferredBuilder.Deferred();if(!userId){deferred.reject();return deferred.promise();}
var url=self.getUrl("Users/"+userId+"/EasyPassword");require(["cryptojs-sha1"],function(){self.ajax({type:"POST",url:url,data:{newPassword:CryptoJS.SHA1(newPassword).toString()}}).done(function(result){deferred.resolveWith(null,[result]);}).fail(function(){deferred.reject();});});return deferred.promise();};self.resetUserPassword=function(userId){if(!userId){throw new Error("null userId");}
var url=self.getUrl("Users/"+userId+"/Password");var postData={};postData.resetPassword=true;return self.ajax({type:"POST",url:url,data:postData});};self.resetEasyPassword=function(userId){if(!userId){throw new Error("null userId");}
var url=self.getUrl("Users/"+userId+"/EasyPassword");var postData={};postData.resetPassword=true;return self.ajax({type:"POST",url:url,data:postData});};self.updateServerConfiguration=function(configuration){if(!configuration){throw new Error("null configuration");}
var url=self.getUrl("System/Configuration");return self.ajax({type:"POST",url:url,data:JSON.stringify(configuration),contentType:"application/json"});};self.updateNamedConfiguration=function(name,configuration){if(!configuration){throw new Error("null configuration");}
var url=self.getUrl("System/Configuration/"+name);return self.ajax({type:"POST",url:url,data:JSON.stringify(configuration),contentType:"application/json"});};self.updateItem=function(item){if(!item){throw new Error("null item");}
var url=self.getUrl("Items/"+item.Id);return self.ajax({type:"POST",url:url,data:JSON.stringify(item),contentType:"application/json"});};self.updatePluginSecurityInfo=function(info){var url=self.getUrl("Plugins/SecurityInfo");return self.ajax({type:"POST",url:url,data:JSON.stringify(info),contentType:"application/json"});};self.createUser=function(name){var url=self.getUrl("Users/New");return self.ajax({type:"POST",url:url,data:{Name:name},dataType:"json"});};self.updateUser=function(user){if(!user){throw new Error("null user");}
var url=self.getUrl("Users/"+user.Id);return self.ajax({type:"POST",url:url,data:JSON.stringify(user),contentType:"application/json"});};self.updateUserPolicy=function(userId,policy){if(!userId){throw new Error("null userId");}
if(!policy){throw new Error("null policy");}
var url=self.getUrl("Users/"+userId+"/Policy");return self.ajax({type:"POST",url:url,data:JSON.stringify(policy),contentType:"application/json"});};self.updateUserConfiguration=function(userId,configuration){if(!userId){throw new Error("null userId");}
if(!configuration){throw new Error("null configuration");}
var url=self.getUrl("Users/"+userId+"/Configuration");return self.ajax({type:"POST",url:url,data:JSON.stringify(configuration),contentType:"application/json"});};self.updateScheduledTaskTriggers=function(id,triggers){if(!id){throw new Error("null id");}
if(!triggers){throw new Error("null triggers");}
var url=self.getUrl("ScheduledTasks/"+id+"/Triggers");return self.ajax({type:"POST",url:url,data:JSON.stringify(triggers),contentType:"application/json"});};self.updatePluginConfiguration=function(id,configuration){if(!id){throw new Error("null Id");}
if(!configuration){throw new Error("null configuration");}
var url=self.getUrl("Plugins/"+id+"/Configuration");return self.ajax({type:"POST",url:url,data:JSON.stringify(configuration),contentType:"application/json"});};self.getAncestorItems=function(itemId,userId){if(!itemId){throw new Error("null itemId");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("Items/"+itemId+"/Ancestors",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getItems=function(userId,options){var url;if((typeof userId).toString().toLowerCase()=='string'){url=self.getUrl("Users/"+userId+"/Items",options);}else{url=self.getUrl("Items",options);}
return self.ajax({type:"GET",url:url,dataType:"json"});};self.getChannels=function(query){return self.getJSON(self.getUrl("Channels",query||{}));};self.getUserViews=function(options,userId){options=options||{};var url=self.getUrl("Users/"+(userId||self.getCurrentUserId())+"/Views",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getArtists=function(userId,options){if(!userId){throw new Error("null userId");}
options=options||{};options.userId=userId;var url=self.getUrl("Artists",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getAlbumArtists=function(userId,options){if(!userId){throw new Error("null userId");}
options=options||{};options.userId=userId;var url=self.getUrl("Artists/AlbumArtists",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getGenres=function(userId,options){if(!userId){throw new Error("null userId");}
options=options||{};options.userId=userId;var url=self.getUrl("Genres",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getMusicGenres=function(userId,options){if(!userId){throw new Error("null userId");}
options=options||{};options.userId=userId;var url=self.getUrl("MusicGenres",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getGameGenres=function(userId,options){if(!userId){throw new Error("null userId");}
options=options||{};options.userId=userId;var url=self.getUrl("GameGenres",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getPeople=function(userId,options){if(!userId){throw new Error("null userId");}
options=options||{};options.userId=userId;var url=self.getUrl("Persons",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getStudios=function(userId,options){if(!userId){throw new Error("null userId");}
options=options||{};options.userId=userId;var url=self.getUrl("Studios",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getLocalTrailers=function(userId,itemId){if(!userId){throw new Error("null userId");}
if(!itemId){throw new Error("null itemId");}
var url=self.getUrl("Users/"+userId+"/Items/"+itemId+"/LocalTrailers");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getAdditionalVideoParts=function(userId,itemId){if(!itemId){throw new Error("null itemId");}
var options={};if(userId){options.userId=userId;}
var url=self.getUrl("Videos/"+itemId+"/AdditionalParts",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getThemeMedia=function(userId,itemId,inherit){if(!itemId){throw new Error("null itemId");}
var options={};if(userId){options.userId=userId;}
options.InheritFromParent=inherit||false;var url=self.getUrl("Items/"+itemId+"/ThemeMedia",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getSearchHints=function(options){var url=self.getUrl("Search/Hints",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.getSpecialFeatures=function(userId,itemId){if(!userId){throw new Error("null userId");}
if(!itemId){throw new Error("null itemId");}
var url=self.getUrl("Users/"+userId+"/Items/"+itemId+"/SpecialFeatures");return self.ajax({type:"GET",url:url,dataType:"json"});};self.getDateParamValue=function(date){function formatDigit(i){return i<10?"0"+i:i;}
var d=date;return""+d.getFullYear()+formatDigit(d.getMonth()+1)+formatDigit(d.getDate())+formatDigit(d.getHours())+formatDigit(d.getMinutes())+formatDigit(d.getSeconds());};self.markPlayed=function(userId,itemId,date){if(!userId){throw new Error("null userId");}
if(!itemId){throw new Error("null itemId");}
var options={};if(date){options.DatePlayed=self.getDateParamValue(date);}
var url=self.getUrl("Users/"+userId+"/PlayedItems/"+itemId,options);return self.ajax({type:"POST",url:url,dataType:"json"});};self.markUnplayed=function(userId,itemId){if(!userId){throw new Error("null userId");}
if(!itemId){throw new Error("null itemId");}
var url=self.getUrl("Users/"+userId+"/PlayedItems/"+itemId);return self.ajax({type:"DELETE",url:url,dataType:"json"});};self.updateFavoriteStatus=function(userId,itemId,isFavorite){if(!userId){throw new Error("null userId");}
if(!itemId){throw new Error("null itemId");}
var url=self.getUrl("Users/"+userId+"/FavoriteItems/"+itemId);var method=isFavorite?"POST":"DELETE";return self.ajax({type:method,url:url,dataType:"json"});};self.updateUserItemRating=function(userId,itemId,likes){if(!userId){throw new Error("null userId");}
if(!itemId){throw new Error("null itemId");}
var url=self.getUrl("Users/"+userId+"/Items/"+itemId+"/Rating",{likes:likes});return self.ajax({type:"POST",url:url,dataType:"json"});};self.getItemCounts=function(userId){var options={};if(userId){options.userId=userId;}
var url=self.getUrl("Items/Counts",options);return self.ajax({type:"GET",url:url,dataType:"json"});};self.clearUserItemRating=function(userId,itemId){if(!userId){throw new Error("null userId");}
if(!itemId){throw new Error("null itemId");}
var url=self.getUrl("Users/"+userId+"/Items/"+itemId+"/Rating");return self.ajax({type:"DELETE",url:url,dataType:"json"});};self.reportPlaybackStart=function(options){if(!options){throw new Error("null options");}
var url=self.getUrl("Sessions/Playing");return self.ajax({type:"POST",data:JSON.stringify(options),contentType:"application/json",url:url});};self.reportPlaybackProgress=function(options){if(!options){throw new Error("null options");}
if(self.isWebSocketOpen()){var deferred=DeferredBuilder.Deferred();var msg=JSON.stringify(options);self.sendWebSocketMessage("ReportPlaybackProgress",msg);deferred.resolveWith(null,[]);return deferred.promise();}
var url=self.getUrl("Sessions/Playing/Progress");return self.ajax({type:"POST",data:JSON.stringify(options),contentType:"application/json",url:url});};self.reportOfflineActions=function(actions){if(!actions){throw new Error("null actions");}
var url=self.getUrl("Sync/OfflineActions");return self.ajax({type:"POST",data:JSON.stringify(actions),contentType:"application/json",url:url});};self.syncData=function(data){if(!data){throw new Error("null data");}
var url=self.getUrl("Sync/Data");return self.ajax({type:"POST",data:JSON.stringify(data),contentType:"application/json",url:url,dataType:"json"});};self.getReadySyncItems=function(deviceId){if(!deviceId){throw new Error("null deviceId");}
var url=self.getUrl("Sync/Items/Ready",{TargetId:deviceId});return self.ajax({type:"GET",url:url,dataType:"json"});};self.reportSyncJobItemTransferred=function(syncJobItemId){if(!syncJobItemId){throw new Error("null syncJobItemId");}
var url=self.getUrl("Sync/JobItems/"+syncJobItemId+"/Transferred");return self.ajax({type:"POST",url:url});};self.reportPlaybackStopped=function(options){if(!options){throw new Error("null options");}
var url=self.getUrl("Sessions/Playing/Stopped");return self.ajax({type:"POST",data:JSON.stringify(options),contentType:"application/json",url:url});};self.sendPlayCommand=function(sessionId,options){if(!sessionId){throw new Error("null sessionId");}
if(!options){throw new Error("null options");}
var url=self.getUrl("Sessions/"+sessionId+"/Playing",options);return self.ajax({type:"POST",url:url});};self.sendCommand=function(sessionId,command){if(!sessionId){throw new Error("null sessionId");}
if(!command){throw new Error("null command");}
var url=self.getUrl("Sessions/"+sessionId+"/Command");var ajaxOptions={type:"POST",url:url};ajaxOptions.data=JSON.stringify(command);ajaxOptions.contentType="application/json";return self.ajax(ajaxOptions);};self.sendMessageCommand=function(sessionId,options){if(!sessionId){throw new Error("null sessionId");}
if(!options){throw new Error("null options");}
var url=self.getUrl("Sessions/"+sessionId+"/Message",options);return self.ajax({type:"POST",url:url});};self.sendPlayStateCommand=function(sessionId,command,options){if(!sessionId){throw new Error("null sessionId");}
if(!command){throw new Error("null command");}
var url=self.getUrl("Sessions/"+sessionId+"/Playing/"+command,options||{});return self.ajax({type:"POST",url:url});};self.createPackageReview=function(review){var url=self.getUrl("Packages/Reviews/"+review.id,review);return self.ajax({type:"POST",url:url,});};self.getPackageReviews=function(packageId,minRating,maxRating,limit){if(!packageId){throw new Error("null packageId");}
var options={};if(minRating){options.MinRating=minRating;}
if(maxRating){options.MaxRating=maxRating;}
if(limit){options.Limit=limit;}
var url=self.getUrl("Packages/"+packageId+"/Reviews",options);return self.ajax({type:"GET",url:url,dataType:"json"});};};})(window,window.JSON,window.WebSocket,window.setTimeout,window.devicePixelRatio,window.FileReader);